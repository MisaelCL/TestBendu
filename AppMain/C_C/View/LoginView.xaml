<Window x:Class="C_C_Final.View.LoginView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModel="clr-namespace:C_C_Final.ViewModel"
        mc:Ignorable="d"
        Title="C_C - Clase &amp; Cita"
        Width="420"
        Height="620"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        d:DataContext="{d:DesignInstance viewModel:LoginViewModel}">

    <!-- Sombra y fondo -->
    <Border Background="#55000000" CornerRadius="16" Padding="1">
        <Border Background="#1F1F1F" CornerRadius="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="42"/>
                    <!-- Barra superior -->
                    <RowDefinition Height="*"/>
                    <!-- Contenido -->
                    <RowDefinition Height="56"/>
                    <!-- Botonera -->
                </Grid.RowDefinitions>

                <!-- Barra superior -->
                <Grid Grid.Row="0" Background="#232323">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="C_C - Clase &amp; Cita"
                               VerticalAlignment="Center"
                               Margin="12,0,0,0"
                               Foreground="#E6E9ED"
                               FontWeight="SemiBold"/>

                    <Button x:Name="btnMinimizar"
                            Grid.Column="1"
                            Width="36" Height="28" Margin="0,6"
                            Content="—"
                            Background="#303030" Foreground="#E6E9ED"
                            BorderBrush="#505050" BorderThickness="1"
                            Click="btnMinimizar_Click"/>

                    <Button x:Name="btnClose"
                            Grid.Column="2"
                            Width="36" Height="28" Margin="6,6,6,6"
                            Content="×"
                            Background="#8A1F1F" Foreground="#E6E9ED"
                            BorderBrush="#B23A3A" BorderThickness="1"
                            Click="btnClose_Click"/>
                </Grid>

                <!-- Contenido -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="24" VerticalAlignment="Center">
                        <TextBlock Text="Bienvenido"
                                   Foreground="#E6E9ED"
                                   FontSize="22"
                                   FontWeight="SemiBold"
                                   Margin="0,12,0,24"/>

                        <!-- Usuario -->
                        <TextBox x:Name="txtUsername"
                                 Height="36"
                                 Padding="8,6"
                                 Background="#2A2A2A"
                                 BorderBrush="#505050"
                                 Foreground="#E6E9ED"
                                 BorderThickness="1"
                                 Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"/>


                        <!-- Contraseña -->
                        <TextBlock Text="Contraseña" Foreground="#C8C8C8" Margin="0,16,0,6"/>
                        <PasswordBox x:Name="passwordBox"
                                     Height="36"
                                     Padding="8,6"
                                     Background="#2A2A2A"
                                     BorderBrush="#505050"
                                     Foreground="#E6E9ED"
                                     BorderThickness="1"
                                     PasswordChanged="PasswordBox_PasswordChanged"
                                     Panel.ZIndex="10"/>

                        <!-- Mensaje de error con DataTrigger (opción B) -->
                        <TextBlock Text="{Binding ErrorMessage}"
                                   Foreground="#FF6B6B"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <!-- por defecto Visible -->
                                    <Setter Property="Visibility" Value="Visible"/>
                                    <Style.Triggers>
                                        <!-- Colapsa si no hay texto -->
                                        <Trigger Property="Text" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="Text" Value="">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>

                        <!-- Enlace a registro -->
                        <TextBlock Text="¿No tienes cuenta? Regístrate"
                                   Margin="0,18,0,0"
                                   Foreground="#9FC2FF"
                                   TextDecorations="Underline"
                                   HorizontalAlignment="Left"
                                   Cursor="Hand">
                            <TextBlock.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding OpenRegistroCommand}"/>
                            </TextBlock.InputBindings>
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>

                <!-- Botonera -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0"
                            Height="38"
                            Margin="24,10,6,10"
                            Content="Iniciar sesión"
                            Command="{Binding LoginCommand}"
                            Background="#3B7BF6" Foreground="White"
                            BorderBrush="#2D5FCC" BorderThickness="1"/>

                    <Button Grid.Column="1"
                            Height="38"
                            Margin="6,10,24,10"
                            Content="Cancelar"
                            Click="btnClose_Click"
                            Background="#3A3A3A" Foreground="#E6E9ED"
                            BorderBrush="#505050" BorderThickness="1"/>
                </Grid>
            </Grid>
        </Border>
    </Border>
</Window>
